---
import Layout from '../layouts/Layout.astro'
import Navbar from '../components/core/layout/Navbar'
import Gallery from '../components/dynamic-page/layout/Gallery'
import Description from '../components/dynamic-page/layout/Description'
import PriceOfPerfumes from '../components/dynamic-page/layout/PriceOfPerfumes'
import { DYNAMIC_ID } from '../utilities/constants/dynamic-pages'

export const getStaticPaths = () => {
  return DYNAMIC_ID.map(({ category, data, id }) => {
    return { params: { category, id }, props: { data, category } }
  })
}
const { data, category } = Astro.props

const infoPerfumes = () => {
  return [
    { name: 'Genero', value: data?.genre },
    { name: 'Marca', value: data?.brand },
    { name: 'Familias Olfativas', value: data.olfactory_families.join(', ') },
  ]
}

const infoCreams = () => {
  return [
    { name: 'Marca', value: data?.brand },
    { name: 'Area', value: data.area.join(', ') },
  ]
}

const info = category == 'creams' ? infoCreams() : infoPerfumes()
const { img, productData, description, context, name } = data
const conditional = context.type == 'Crema' || context.type == 'Gel'
const title = conditional ? `${name} - ${context.type} ${context.highlight}` : `${name} - ${context.type} en ${context.highlight}`
---

<Layout>
  <Navbar client:load />
  <main class='text-black grid grid-cols-1 lg:grid-cols-2 gap-8 p-8 test justify-center'>
    <Gallery client:load imgDefault={img} images={productData} />

    <article class=''>
      <h2 class='text-3xl font-basicaline font-semibold'>{title}</h2>
      <p class='text-gray-600'>{data?.context.brand}</p>
      <PriceOfPerfumes prices={productData} client:load />
      <Description description={description} info={info} client:load />
    </article>

    {
      category == 'creams' ? (
        <>
          {data.extra.map((el: any) => (
            <section>
              <h3>{el.title}</h3>
              <p>{el.description}</p>
            </section>
          ))}
        </>
      ) : null
    }
  </main>
</Layout>
